2.4 Representações múltiplas para dados abstratos

Introduzimos a abstração de dados, uma metodologia para estruturar sistemas de tal forma que muito de um programa pode ser especificado independentemente das escolhas envolvidas na implementação dos objetos de dados que o programa manipula. Por exemplo, vimos na seção [2.1.1](https://so45nujb3h4koud7nsjm2lne4u-ac4c6men2g7xr2a-github.translate.goog/sicp/chapters/2.1.1.html) como separar a tarefa de projetar um programa que usa números racionais da tarefa de implementar números racionais em termos dos mecanismos primitivos da linguagem de computador para construir dados compostos. A ideia principal era para erigir uma abstracção barreira, neste caso, os selectores e construtores para números racionais ( make_rat, numer, denom), isto isola a maneira como os números racionais são utilizados a partir de sua representação subjacente em termos de estrutura lista. Uma barreira de abstracção semelhante isola os detalhes das funções que executam a aritmética racional add_rat, sub_rat, mul_rat, e div_rat) a partir do Nível superior funções que usam números racionais. O programa resultante tem a estrutura mostrada na figura [2,1](https://so45nujb3h4koud7nsjm2lne4u-ac4c6men2g7xr2a-github.translate.goog/sicp/chapters/2.1.2.html#fig_2.1) .

Essas barreiras de abstração de dados são ferramentas poderosas para controlar a complexidade. Ao isolar as representações subjacentes de objetos de dados, podemos dividir a tarefa de projetar um grande programa em tarefas menores que podem ser executadas separadamente. Mas esse tipo de abstração de dados ainda não é poderoso o suficiente, porque nem sempre faz sentido falar de a representação subjacente para um objeto de dados.

Por um lado, pode haver mais de uma representação útil para um objeto de dados e gostaríamos de projetar sistemas que podem lidar com várias representações. Para dar um exemplo simples, os números complexos podem ser representados de duas maneiras quase equivalentes: na forma retangular (partes reais e imaginárias) e na forma polar (magnitude e ângulo). Às vezes, a forma retangular é mais apropriada e às vezes a forma polar é mais apropriada. Na verdade, é perfeitamente plausível imaginar um sistema no qual números complexos são representados de ambas as maneiras e no qual as funções para manipular números complexos funcionam com qualquer uma das representações.

Mais importante, os sistemas de programação são frequentemente projetados por muitas pessoas que trabalham por longos períodos de tempo, sujeitos a requisitos que mudam com o tempo. Em tal ambiente, simplesmente não é possível que todos concordem com antecedência sobre as escolhas de representação de dados. Portanto, além das barreiras de abstração de dados que isolam a representação do uso, precisamos de barreiras de abstração que isolem diferentes opções de design umas das outras e permitam que diferentes escolhas coexistam em um único programa. Além disso, uma vez que programas grandes são frequentemente criados pela combinação de módulos preexistentes que foram projetados isoladamente, precisamos de convenções que permitam aos programadores incorporar módulos em sistemas maiores _aditivamente_ , isto é, sem ter que reprojetar ou reimplementar esses módulos.

Nesta seção, aprenderemos como lidar com dados que podem ser representados de diferentes maneiras por diferentes partes de um programa. Isso requer a construção de _funções genéricas - funções_ que podem operar em dados que podem ser representados de mais de uma maneira. Nossa principal técnica para construir funções genéricas será trabalhar em termos de objetos de dados que possuem _tags de tipo_ , ou seja, objetos de dados que incluem informações explícitas sobre como devem ser processados. Também discutiremos _a_ programação _direcionada a dados_ , uma estratégia de implementação poderosa e conveniente para sistemas de montagem aditiva com operações genéricas.

Começamos com o exemplo de número complexo simples. Veremos como as tags de tipo e o estilo direcionado por dados nos permitem projetar representações retangulares e polares separadas para números complexos, mantendo a noção de um abstrato número complexo objeto de dados. Vamos fazer isso através da definição de funções aritméticas para números complexos ( add_complex, sub_complex, mul_complexe div_complex) em termos de seletores genéricos que partes de acesso de um número independente complexo de como o número é representado. O sistema de número complexo resultante, conforme mostrado na figura [2,19](https://so45nujb3h4koud7nsjm2lne4u-ac4c6men2g7xr2a-github.translate.goog/sicp/chapters/2.4.html#fig_2.19) , contém dois tipos diferentes de barreiras de abstração. O horizontal barreiras de abstração desempenham o mesmo papel que as da figura [2,1](https://so45nujb3h4koud7nsjm2lne4u-ac4c6men2g7xr2a-github.translate.goog/sicp/chapters/2.1.2.html#fig_2.1) . Eles isolam Nível superior operações de nível mais baixo representações. Além disso, há um vertical barreira que nos dá a capacidade de projetar e instalar separadamente representações alternativas. ![](https://source-academy.github.io/sicp/img_javascript/ch2-Z-G-54.svg)

![](https://source-academy.github.io/sicp/img_javascript/ch2-Z-G-54.svg)

**[Figura 2.19](https://so45nujb3h4koud7nsjm2lne4u-ac4c6men2g7xr2a-github.translate.goog/sicp/chapters/2.4.html#fig_2.19)** Barreiras de abstração de dados no sistema de números complexos.

Na seção [2,5](https://so45nujb3h4koud7nsjm2lne4u-ac4c6men2g7xr2a-github.translate.goog/sicp/chapters/2.5.html) mostraremos como usar tags de tipo e estilo direcionado a dados para desenvolver um pacote aritmético genérico. Isso fornece funções ( add, mule assim por diante) que podem ser usadas para manipular todos os tipos de números e pode ser facilmente estendido quando um novo tipo de número é necessário. Na seção [2.5.3](https://so45nujb3h4koud7nsjm2lne4u-ac4c6men2g7xr2a-github.translate.goog/sicp/chapters/2.5.3.html) , mostraremos como usar aritmética genérica em um sistema que executa álgebra simbólica.
